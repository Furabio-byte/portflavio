<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Portfolio personale di Flavio con progetti, altri lavori, percorso e testi">
  <meta name="theme-color" content="#808000">
  <meta name="color-scheme" content="light dark">
  
  <!-- Sicurezza -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; style-src 'self' https://fonts.googleapis.com 'unsafe-inline'; script-src 'self';">

  <title>Portflavio - Portfolio Personale</title>

  <!-- Preload ottimizzato -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display+SC:wght@400;900&display=swap" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="css/style.css">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
</head>
<body>
  <header>
    <nav class="schede-container" aria-label="Navigazione principale">
      <!-- Project Card -->
      <a href="#project" class="scheda-link" aria-label="Progetti - 2 progetti disponibili">
        <article class="scheda">
          <span class="lettera" aria-hidden="true">P</span>
          <span class="parola">Project</span>
          <span class="numero">2</span>
        </article>
      </a>

      <!-- Others Card -->
      <a href="#others" class="scheda-link" aria-label="Altri lavori">
        <article class="scheda">
          <span class="lettera" aria-hidden="true">O</span>
          <span class="parola">Others</span>
          <span class="numero">0</span>
        </article>
      </a>

      <!-- Road Card -->
      <a href="#road" class="scheda-link" aria-label="Percorso - 2 elementi">
        <article class="scheda">
          <span class="lettera" aria-hidden="true">R</span>
          <span class="parola">Road</span>
          <p class="frase-r" lang="la">
            LOREM IPSUM DOLOR
            SIT AMET, CONSECTETUR
            ADIPISCING ELIT.
          </p>
          <span class="numero">2</span>
        </article>
      </a>

      <!-- Text Card -->
      <a href="#text" class="scheda-link" aria-label="Testi - 5 testi disponibili">
        <article class="scheda">
          <span class="lettera" aria-hidden="true">T</span>
          <span class="parola">Text</span>
          <span class="numero">5</span>
        </article>
      </a>
    </nav>
  </header>

  <main id="main-content">
    <!-- Sezione Projects -->
    <section id="project" class="text-page-container">
      <div class="scheda-text">
        <div class="text-content">
          <h2 class="text-title">Projects</h2>
          <div class="text-description">
            <!-- Contenuto dei progetti -->
          </div>
        </div>
      </div>
    </section>

    <!-- Sezione Others -->
    <section id="others" class="text-page-container">
      <div class="scheda-text">
        <div class="text-content">
          <h2 class="text-title">Others</h2>
          <div class="text-description">
            <!-- Contenuto altri lavori -->
          </div>
        </div>
      </div>
    </section>

    <!-- Sezione Road -->
    <section id="road" class="text-page-container">
      <div class="scheda-text">
        <div class="text-content">
          <h2 class="text-title">Road</h2>
          <div class="text-description">
            <!-- Contenuto percorso -->
          </div>
        </div>
      </div>
    </section>

    <!-- Sezione Text -->
    <section id="text" class="text-page-container">
      <div class="scheda-text">
        <div class="text-content">
          <h2 class="text-title">Text</h2>
          <div class="text-description">
            <!-- Contenuto testi -->
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Funzione di easing più dolce
      const easeInOutSextuple = (t) => {
        return t < 0.5
          ? 32 * t * t * t * t * t * t
          : 1 - Math.pow(-2 * t + 2, 6) / 2;
      };

      const smoothScroll = (targetElement) => {
        const startPosition = window.pageYOffset;
        const targetPosition = targetElement.getBoundingClientRect().top + startPosition;
        const distance = targetPosition - startPosition;
        
        // Durate aumentate significativamente
        const baseDuration = 2500; // 2.5 secondi come base
        const minDuration = 2000;  // minimo 2 secondi
        const maxDuration = 3000;  // massimo 3 secondi
        
        let start = null;

        // Calcolo durata in base alla distanza
        const adjustedDuration = Math.min(
          maxDuration,
          Math.max(
            minDuration,
            Math.abs(distance) / 500 * baseDuration // Più lento per distanze maggiori
          )
        );

        const step = (timestamp) => {
          if (!start) start = timestamp;
          const progress = timestamp - start;
          const percentage = Math.min(progress / adjustedDuration, 1);
          
          // Applica l'easing più dolce
          const easing = easeInOutSextuple(percentage);
          
          // Calcolo posizione con più precisione
          const currentPosition = startPosition + (distance * easing);
          
          // Scroll più fluido
          window.scrollTo({
            top: currentPosition,
            behavior: 'auto'
          });

          if (progress < adjustedDuration) {
            window.requestAnimationFrame(step);
          } else {
            // Assicurati di arrivare esattamente a destinazione
            window.scrollTo({
              top: targetPosition,
              behavior: 'auto'
            });
          }
        };

        window.requestAnimationFrame(step);
      };

      // Gestione eventi di scroll migliorata
      let isScrolling = false;
      
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Previeni scroll multipli
          if (isScrolling) return;
          
          const targetId = this.getAttribute('href');
          const targetElement = document.querySelector(targetId);
          
          if (targetElement) {
            isScrolling = true;
            
            smoothScroll(targetElement);
            
            // Aggiorna URL senza salti
            history.pushState(null, '', targetId);
            
            // Reset del flag dopo un tempo superiore alla durata massima
            setTimeout(() => {
              isScrolling = false;
            }, 3500);
          }
        });
      });
    });
  </script>
  
</body>
</html>